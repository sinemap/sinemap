var q,jsonFeedUrl="/feeds/feed.json",$searchForm=$("[data-search-form]"),$searchInput=$("[data-search-input]"),$resultTemplate=$("#search-result"),$resultsPlaceholder=$("[data-search-results]"),$foundContainer=$("[data-search-found]"),$foundTerm=$("[data-search-found-term]"),$foundCount=$("[data-search-found-count]"),allowEmpty=!0,showLoader=!0,loadingClass="is--loading";function initSearch(){getParameterByName("q")&&(q=decodeURIComponent(getParameterByName("q")),$searchInput.val(q),execSearch(q)),$(document).on("submit",$searchForm,function(e){e.preventDefault(),execSearch(q=$searchInput.val())})}function execSearch(e){(""!=e||allowEmpty)&&(showLoader&&toggleLoadingClass(),getSearchResults(processData()))}function toggleLoadingClass(){$resultsPlaceholder.toggleClass(loadingClass),$foundContainer.toggleClass(loadingClass)}function getSearchResults(e){$.get(jsonFeedUrl,e,"json")}function processData(){return $results=[],function(e){var t=0,n="";$.each(e,function(e,a){if("true"!=a.search_omit&&(a.content.toLowerCase().indexOf(q.toLowerCase())>-1||a.title.toLowerCase().indexOf(q.toLowerCase())>-1)){var o=populateResultContent($resultTemplate.html(),a);t++,n+=o}}),showLoader&&toggleLoadingClass(),populateResultsString(t),showSearchResults(n)}}function showSearchResults(e){$resultsPlaceholder.html(e)}function populateResultContent(e,t){return e=injectContent(e=injectContent(e=injectContent(e=injectContent(e=injectContent(e,t.title,"##Title##"),t.link,"##Url##"),t.excerpt,"##Excerpt##"),t.date,"##Date##"),t.category,"##Category##")}function populateResultsString(e){$foundTerm.text(q),$foundCount.text(e),$foundContainer.show()}function getParameterByName(e){var t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))}function injectContent(e,t,n){var a=new RegExp(n,"g");return e.replace(a,t)}$(document).ready(function(){$foundContainer.hide(),initSearch()});